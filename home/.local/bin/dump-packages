#!/bin/sh

set -e

# Avoid triggering ssh-askpass (use the unprotected cron key).
unset SSH_ASKPASS

mkdir -p ~/backups/packages/$(hostname)
cd ~/backups/packages/$(hostname)

pacman -Qeqn > explicit-native
pacman -Qeqm > explicit-foreign
pacman -Qdqn > dependencies-native
pacman -Qdqm > dependencies-foreign

git add .
git commit -m "Auto package list backup."
git pull -r origin master
git push origin master
