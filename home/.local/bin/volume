#!/bin/sh

set -e

if [ -z $1 ]; then
  true
elif [ $1 == decrease ]; then
  COMMAND="decrease 3"
elif [ $1 == increase ]; then
  COMMAND="increase 3"
elif [ $1 == min ]; then
  COMMAND="set-volume 0"
elif [ $1 == max ]; then
  COMMAND="set-volume 100"
elif [ $1 == toggle ]; then
  COMMAND="toggle"
else
  echo "Bad argument"
  exit -1
fi

if [ -z "$COMMAND" ]; then
  true  # No command to run
else
  # Set the volume for bluetooth devices.
  for dev in $(ponymix --sink --short list | grep bluez | cut -f 3); do
    ponymix -d $dev $COMMAND > /dev/null
  done
  # Keep volume for the builtin speakers mute.
  for dev in $(ponymix --sink --short list | grep alsa | cut -f 3); do
    ponymix -d $dev mute > /dev/null
    ponymix -d $dev set-volume 0 > /dev/null
  done
fi

volume-notify
