#
# muttrc (Mutt 1.5.22)
#
# Last reviewed 2014-11-10

# Default notmuch database location.
set nm_default_uri = notmuch:///home/hugo/.local/share/maildir

# Other files with additional configuration.
source ~/.config/mutt/macros
source ~/.config/mutt/crypto
source ~/.config/mutt/colours

# I use maildir exclusively.
set mbox_type = Maildir

# Outgoing is relayed via smtpd.
set smtp_url = "smtp://localhost"

# Set the root directory for all mailboxes.
set folder	= "~/.local/share/maildir/"
# Default mailbox.
set spoolfile	= +INBOX
# Other mailboxes.
set record    = "+INBOX"
set postponed = "+Drafts"

# Per-account hooks
send-hook ".*alivecor.com|.*minimalistech.com" set from = "hugo@minimalistech.com"
send-hook ".*alivecor.com|.*minimalistech.com" set signature = "~/.signature_short"
send-hook ".*alivecor.com|.*minimalistech.com" set crypt_autosign = no
# TODO: generate a GPG key for the alternate and use crypt-hook.
# FIXME: email sent right after the above retain those settings!

# Composing and replying
set from           = "hugo@barrera.io"      # Default email address.
alternates           ".{4,}@barrera.io|.*@osvaldobarrera.com.ar|hugo@minimalistech.com"
alternates           "hugo87theone@gmail.com|huguito.87@gmail.com"
alternates           "hugo@interlap.com.ar|hbarrera@hotpop.com"
set reverse_name   = yes                    # Reply from alternates automatically.
set realname       = "Hugo Osvaldo Barrera" # Name used when composing.
set reverse_realname = no                   # Reply using my real name.
set copy           = yes                    # Keep copies of outgoing mail.
set move	   = no                     # Keep mails where the are when read.
set fcc_attach     = yes                    # Keep attachment in local copy.
set attach_charset = "utf-8"

set forward_format = "Fwd: %s"              # Prefix to use when forwarding messages.
set forward_quote  = yes                    # Quote the email body when forwarding.
set include        = yes                    # Quote the email body when replying.
set autoedit       = no                     # Go to the editor right away when composing.
set editor         = "vim +7"               # Place the cursor below the default headers.
set edit_headers   = yes                    # Let me edit the message header when composing.
set include        = yes                    # Always include messages when replying.
set reply_to       = yes                    # Always use reply-to if present.
set crypt_autosign = yes                    # Sign outgoing messages.

# Integration
set beep_new = yes			# Beep when new messages arrive.
set query_command = "khard mutt --search '%s'"  # Complete emails from the vcard store.
set header_cache = ~/.cache/mutt_hcache	# Keep a header cache.

# Display formatting
set folder_format="%2C %t %f"
set date_format="%F %R"
set index_format="%3C %Z %D  %-30.30F %?M?[%M]? %s"

# Navigating and reading
set arrow_cursor  = no        # Use -> instead of hiliting the whole line.
set confirmappend = no        # Don't ask me if i want to append to mailboxes.
set mark_old      = no        # I don't care about whether a message is old.
set mail_check    = 3         # How often to poll for new mail.
set read_inc      = 25        # Show progress when reading a mailbox.
set sort          = threads   # Sort messages into threads.
set sort_aux      = last-date # TODO: make last-date-received work!
set tilde         = yes	      # Virtual lines to pad blank lines in the pager.
set markers       = no        # Don't show "+" for wrapped lines.
set write_inc     = 25        # Show progress while writing mailboxes.
set pager_index_lines = 7     # Index lines to show when reading.
set pager_stop    = yes       # Don't jump to next message when scrolling.
set auto_tag      = yes       # Always operate on tagged messages.

# Message headers
ignore      *
unignore    from subject to cc mail-followup-to date x-mailer x-url
unhdr_order *
hdr_order   date from subject to cc

# Attachments and HTML
set mailcap_path = ~/.config/mutt/mailcap
alternative_order text/plain text/html
auto_view text/html

# Open URLs in emails.
macro index \cb |urlview\n
macro pager \cb |urlview\n

# Other key bindings
bind generic "\e<" first-entry	# emacs-like bindings for moving to top/bottom
bind generic \e> last-entry
bind generic { top-page
bind generic } bottom-page
bind generic \177 last-entry
bind pager   G bottom

# Save to the archives by default (provides a sane default).
save-hook ^ =Archives
